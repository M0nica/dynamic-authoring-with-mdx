{"ast":null,"code":"import { useEffect, useState } from 'react';\nimport { useRouter } from 'next/router';\nimport { useCurrentSlide } from '../context/CurrentSlideContext';\nvar keys = {\n  slide: 'next-mdx-deck-slide',\n  page: 'next-mdx-deck-page'\n};\nexport var useStorage = function useStorage() {\n  var _useCurrentSlide = useCurrentSlide(),\n      currentSlide = _useCurrentSlide.currentSlide,\n      setSlide = _useCurrentSlide.setSlide;\n\n  var router = useRouter();\n  var currentPage = router.query && 'slide' in router.query && parseInt(router.query.slide, 10);\n\n  var _useState = useState(false),\n      focused = _useState[0],\n      setFocused = _useState[1];\n  /**\n   * Checks when user enters (focus) or\n   * leaves (blur) browser window/tab\n   */\n\n\n  var handleFocus = function handleFocus() {\n    return setFocused(true);\n  };\n\n  var handleBlur = function handleBlur() {\n    return setFocused(false);\n  };\n  /**\n   * Updates route or context with local storage data\n   * from event listener\n   * @param {*} e\n   */\n\n\n  var handleStorageChange = function handleStorageChange(e) {\n    var n = parseInt(e.newValue, 10);\n    var syncedSlide = localStorage.getItem(keys.slide); // if (focused) return\n\n    if (Number.isNaN(n)) return;\n\n    switch (e.key) {\n      case keys.page:\n        router.push(\"/slides/\".concat(parseInt(n, 10), \"#\").concat(syncedSlide));\n        break;\n\n      case keys.slide:\n        window.location.hash = \"#\".concat(n);\n        setSlide(n);\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  useEffect(function () {\n    setFocused(document.hasFocus());\n  }, []);\n  useEffect(function () {\n    if (!focused) window.addEventListener('storage', handleStorageChange);\n    window.addEventListener('focus', handleFocus);\n    window.addEventListener('blur', handleBlur);\n    return function () {\n      if (!focused) window.removeEventListener('storage', handleStorageChange);\n      window.removeEventListener('focus', handleFocus);\n      window.removeEventListener('blur', handleBlur);\n    };\n  }, [focused]);\n  /**\n   * Sync localstorage with changes to slides or pages\n   */\n\n  useEffect(function () {\n    if (!focused) return;\n    localStorage.setItem(keys.slide, currentSlide);\n    localStorage.setItem(keys.page, currentPage);\n  }, [focused, currentSlide, currentPage]);\n};\nexport var Storage = function Storage() {\n  useStorage();\n  return false;\n};\nexport default useStorage;","map":{"version":3,"sources":["/Users/monica/Dev/migrating-to-mdx/hooks/useStorage.js"],"names":["useEffect","useState","useRouter","useCurrentSlide","keys","slide","page","useStorage","currentSlide","setSlide","router","currentPage","query","parseInt","focused","setFocused","handleFocus","handleBlur","handleStorageChange","e","n","newValue","syncedSlide","localStorage","getItem","Number","isNaN","key","push","window","location","hash","document","hasFocus","addEventListener","removeEventListener","setItem","Storage"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react'\nimport { useRouter } from 'next/router'\nimport { useCurrentSlide } from '../context/CurrentSlideContext'\n\nconst keys = {\n  slide: 'next-mdx-deck-slide',\n  page: 'next-mdx-deck-page',\n}\n\nexport const useStorage = () => {\n  const { currentSlide, setSlide } = useCurrentSlide()\n  const router = useRouter()\n  const currentPage =\n    router.query && 'slide' in router.query && parseInt(router.query.slide, 10)\n  const [focused, setFocused] = useState(false)\n\n  /**\n   * Checks when user enters (focus) or\n   * leaves (blur) browser window/tab\n   */\n  const handleFocus = () => setFocused(true)\n  const handleBlur = () => setFocused(false)\n\n  /**\n   * Updates route or context with local storage data\n   * from event listener\n   * @param {*} e\n   */\n  const handleStorageChange = (e) => {\n    const n = parseInt(e.newValue, 10)\n    const syncedSlide = localStorage.getItem(keys.slide)\n    // if (focused) return\n    if (Number.isNaN(n)) return\n    switch (e.key) {\n      case keys.page:\n        router.push(`/slides/${parseInt(n, 10)}#${syncedSlide}`)\n        break\n      case keys.slide:\n        window.location.hash = `#${n}`\n        setSlide(n)\n        break\n      default:\n        break\n    }\n  }\n\n  useEffect(() => {\n    setFocused(document.hasFocus())\n  }, [])\n\n  useEffect(() => {\n    if (!focused) window.addEventListener('storage', handleStorageChange)\n    window.addEventListener('focus', handleFocus)\n    window.addEventListener('blur', handleBlur)\n    return () => {\n      if (!focused) window.removeEventListener('storage', handleStorageChange)\n      window.removeEventListener('focus', handleFocus)\n      window.removeEventListener('blur', handleBlur)\n    }\n  }, [focused])\n\n  /**\n   * Sync localstorage with changes to slides or pages\n   */\n  useEffect(() => {\n    if (!focused) return\n    localStorage.setItem(keys.slide, currentSlide)\n    localStorage.setItem(keys.page, currentPage)\n  }, [focused, currentSlide, currentPage])\n}\n\nexport const Storage = () => {\n  useStorage()\n  return false\n}\n\nexport default useStorage\n"]},"metadata":{},"sourceType":"module"}